temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_point(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_hull(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(16, 26, by=1)))+
ggforce::geom_mark_ellipse(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
install.packages("concaveman")
library(nur1027functions)
library(tidyverse)
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_point(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_hull(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(16, 26, by=1)))+
ggforce::geom_mark_ellipse(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_hull(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(16, 26, by=1)))+
ggforce::geom_mark_ellipse(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_rect(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(16, 26, by=1)))+
ggforce::geom_mark_ellipse(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_ellipse(aes(filter = Hypothermic == 'hypothermic' & BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_ellipse(aes(filter = BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()+
ggforce::geom_mark_ellipse(aes(filter = BMI == seq(30, 45, by = 1)))+
scale_x_continuous(limits = c(16,47))
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()
suppressMessages(print(p))
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
theme_minimal()
suppressMessages(print(p))
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(low_bmi = case_when(BMI<25 ~ "low",
BMI>24 & BMI <33 ~ "mid",
BMI>33 ~ "high"))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(low_bmi = case_when(BMI<25 ~ "low",
BMI>24 & BMI <33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
geom_mark_rect(aes(fill = low_bmi)) +
theme_minimal()
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(low_bmi = case_when(BMI<25 ~ "low",
BMI>24 & BMI <33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_elipse(aes(fill = low_bmi)) +
theme_minimal()
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_ellipse(aes(fill = low_bmi)) +
theme_minimal()
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_ellipse(aes(fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "low", fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high", fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>25 & BMI <=33 ~ "mid",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = low_bmi)) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = low_bmi)) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = low_bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = bmi)) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = bmi)) +
theme_minimal()
suppressMessages(print(p))
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>33 ~ "high"))
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
temp_logistic <- temp_logistic %>%
mutate(Hypothermic = as_factor(Hypothermic)) %>%
mutate(Propofol_used = as_factor(Propofol_used)) %>%
mutate(bmi = case_when(BMI<=25 ~ "low",
BMI>33 ~ "high"))
options(warn = -1)
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = bmi), legend=NULL) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = bmi)) +
theme_minimal()
suppressMessages(print(p))
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = bmi), legend=FALSE) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = bmi)) +
theme_minimal()
suppressMessages(print(p))
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = bmi), show.legend=FALSE) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = bmi)) +
theme_minimal()
suppressMessages(print(p))
p <- ggplot(temp_logistic, aes(x = BMI, y=Hypothermic))+
geom_jitter(width = 0, height = 0.1, alpha = 0.3)+
ggforce::geom_mark_rect(aes(filter = bmi== "high" & Hypothermic == "hypothermic", fill = bmi), show.legend=FALSE) +
ggforce::geom_mark_rect(aes(filter = bmi== "low" & Hypothermic == "hypothermic", fill = bmi), show.legend = FALSE) +
theme_minimal()
suppressMessages(print(p))
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
)
tidy
tidy$term
tidy$term[3]
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol = "
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
)
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
)
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
tidy$term["Propofol_used"]
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term["Propofol_used"]
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
) %>%
data_color(
columns = OR,
colors = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
) %>%
data_color(
columns = OR,
colors = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
) %>%
data_color(
columns = oddsratio,
colors = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
) %>%
data_color(
columns = oddsratio,
color = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt() %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
) %>%
data_color(
columns = OR,
color = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt()%>%
data_color(
columns = oddsratio,
colors = "red") %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
)
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(infer)
library(gt)
library(nur1027functions)
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt()%>%
data_color(
columns = oddsratio,
colors = "red")
model <- temp_logistic %>%
glm(formula = Hypothermic ~ BMI + Propofol_used,family = "binomial")
tidy <- broom::tidy(model)
tidy <- tidy %>%
mutate(oddsratio= exp(estimate))
confint <- suppressMessages(confint(model)) %>%
exp
tidy <- cbind(tidy, confint)
tidy$term[3] <- "Propofol"
tidy %>%
mutate_if(is.numeric, ~round(., 1)) %>%
gt()%>%
data_color(
columns = vars(oddsratio),
colors = "red") %>%
cols_label(
estimate = html("&beta;"), oddsratio= "OR"
)
